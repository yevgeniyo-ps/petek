const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/md-editor-C1q9TcpX.js","assets/react-vendor-tRUzE08Q.js","assets/md-editor-BI4-FgBR.css"])))=>i.map(i=>d[i]);
import{u as F,r as V,a as H,V as q,b as I,v as $,t as U,j as e,c as P,d as B}from"./md-editor-C1q9TcpX.js";import{r as m}from"./react-vendor-tRUzE08Q.js";import{c as y,N as v,T as G,u as J,a as L,t as K,f as X,M as Q,X as W,b as S,_ as Y}from"./index-BFU_njf7.js";import{C as Z}from"./ConfirmDialog-CjtMJDw2.js";import{C as ee}from"./chevron-down-B4Rhi2K0.js";const te=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h2",key:"tvwodi"}],["path",{d:"M20 8v11a2 2 0 0 1-2 2h-2",key:"1gkqxj"}],["path",{d:"m9 15 3-3 3 3",key:"1pd0qc"}],["path",{d:"M12 12v9",key:"192myk"}]],se=y("archive-restore",te);const re=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],oe=y("archive",re);const le=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],ae=y("palette",le);const ne=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],ie=y("pin-off",ne);const ce=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],de=y("pin",ce),me="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",z=[],M={allowDangerousHtml:!0},ue=/^(https?|ircs?|mailto|xmpp)$/i,pe=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function xe(t){const s=fe(t),r=he(t);return ge(s.runSync(s.parse(r),r),t)}function fe(t){const s=t.rehypePlugins||z,r=t.remarkPlugins||z,l=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...M}:M;return F().use(V).use(r).use(H,l).use(s)}function he(t){const s=t.children||"",r=new q;return typeof s=="string"&&(r.value=s),r}function ge(t,s){const r=s.allowedElements,l=s.allowElement,d=s.components,x=s.disallowedElements,f=s.skipHtml,h=s.unwrapDisallowed,u=s.urlTransform||be;for(const o of pe)Object.hasOwn(s,o.from)&&I("Unexpected `"+o.from+"` prop, "+(o.to?"use `"+o.to+"` instead":"remove it")+" (see <"+me+"#"+o.id+"> for more info)");return $(t,n),U(t,{Fragment:e.Fragment,components:d,ignoreInvalidStyle:!0,jsx:e.jsx,jsxs:e.jsxs,passKeys:!0,passNode:!0});function n(o,i,p){if(o.type==="raw"&&p&&typeof i=="number")return f?p.children.splice(i,1):p.children[i]={type:"text",value:o.value},i;if(o.type==="element"){let c;for(c in P)if(Object.hasOwn(P,c)&&Object.hasOwn(o.properties,c)){const j=o.properties[c],b=P[c];(b===null||b.includes(o.tagName))&&(o.properties[c]=u(String(j||""),c,o))}}if(o.type==="element"){let c=r?!r.includes(o.tagName):x?x.includes(o.tagName):!1;if(!c&&l&&typeof i=="number"&&(c=!l(o,i,p)),c&&p&&typeof i=="number")return h&&o.children?p.children.splice(i,1,...o.children):p.children.splice(i,1),i}}}function be(t){const s=t.indexOf(":"),r=t.indexOf("?"),l=t.indexOf("#"),d=t.indexOf("/");return s===-1||d!==-1&&s>d||r!==-1&&s>r||l!==-1&&s>l||ue.test(t.slice(0,s))?t:""}function D({current:t,onChange:s}){return e.jsx("div",{className:"flex flex-wrap gap-2 p-3 max-w-[260px]",children:Object.entries(v).map(([r,l])=>e.jsx("button",{onClick:()=>s(r),title:l.name,className:"w-7 h-7 rounded-full border-2 transition-all hover:scale-110",style:{backgroundColor:l.bg,borderColor:t===r?"#ec4899":l.border,boxShadow:t===r?"0 0 0 1px #ec4899":"none"}},r))})}function we({isPinned:t,isArchived:s,onTogglePin:r,onColorChange:l,onArchive:d,onRestore:x,onDelete:f,currentColor:h}){const[u,n]=m.useState(!1),o="p-2 rounded-lg hover:bg-white/[0.06] text-[#6b6882] hover:text-[#b0adc0] transition-colors";return e.jsxs("div",{className:"flex items-center gap-1 relative",children:[!s&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:o,title:t?"Unpin":"Pin",children:t?e.jsx(ie,{size:16}):e.jsx(de,{size:16})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>n(!u),className:o,title:"Color",children:e.jsx(ae,{size:16})}),u&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),e.jsx("div",{className:"absolute bottom-full left-0 mb-2 z-20 bg-[#1e1b2e] border border-[#2d2a40] rounded-xl shadow-xl shadow-black/40",children:e.jsx(D,{current:h,onChange:i=>{l(i),n(!1)}})})]})]}),d&&e.jsx("button",{onClick:d,className:o,title:"Archive",children:e.jsx(oe,{size:16})})]}),s&&e.jsxs(e.Fragment,{children:[x&&e.jsx("button",{onClick:x,className:o,title:"Restore",children:e.jsx(se,{size:16})}),f&&e.jsx("button",{onClick:f,className:"p-2 rounded-lg hover:bg-white/[0.06] text-[#6b6882] hover:text-[#f87171] transition-colors",title:"Delete permanently",children:e.jsx(G,{size:16})})]})]})}function ve({note:t,onClick:s}){const{updateNote:r,deleteNote:l}=J(),{getLabelsForNote:d}=L(),[x,f]=m.useState(!1),h=v[t.color]??v.default,u=d(t.id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:s,className:"group rounded-xl border cursor-pointer transition-all hover:border-[#2d2a40] flex flex-col min-h-[140px]",style:{backgroundColor:h.bg,borderColor:h.border},children:[e.jsxs("div",{className:"p-4 flex-1 min-h-0",children:[t.title&&e.jsx("h3",{className:"text-[14px] font-semibold text-white mb-2 line-clamp-2",children:t.title}),t.content&&e.jsx("div",{className:"text-[13px] text-[#9896a8] line-clamp-6 leading-relaxed",children:e.jsx(xe,{remarkPlugins:[B],children:K(t.content,200)})})]}),u.length>0&&e.jsx("div",{className:"px-4 pb-2 flex flex-wrap gap-1",children:u.map(n=>e.jsx("span",{className:"inline-block px-2 py-0.5 rounded-full bg-[#ec4899]/20 text-[#f472b6] text-[10px] font-medium",children:n.name},n.id))}),e.jsxs("div",{className:"px-3 py-2.5 flex items-center justify-between opacity-0 group-hover:opacity-100 transition-opacity",onClick:n=>n.stopPropagation(),children:[e.jsx(we,{isPinned:t.is_pinned,isArchived:t.is_archived,onTogglePin:()=>r(t.id,{is_pinned:!t.is_pinned}),onColorChange:n=>r(t.id,{color:n}),onArchive:()=>r(t.id,{is_archived:!0}),onRestore:()=>r(t.id,{is_archived:!1}),onDelete:()=>f(!0),currentColor:t.color}),e.jsx("span",{className:"text-[11px] text-[#4a4660]",children:X(t.updated_at)})]})]}),e.jsx(Z,{open:x,onClose:()=>f(!1),onConfirm:()=>l(t.id),title:"Delete forever?",message:"This note will be permanently deleted."})]})}function Pe({notes:t,onNoteClick:s,sectionTitle:r}){return t.length===0?null:e.jsxs("div",{className:"mb-8",children:[r&&e.jsx("h2",{className:"text-[11px] font-semibold text-[#7a7890] uppercase tracking-wider mb-4",children:r}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:t.map(l=>e.jsx(ve,{note:l,onClick:()=>s(l)},l.id))})]})}const ye=m.lazy(()=>Y(()=>import("./md-editor-C1q9TcpX.js").then(t=>t.i),__vite__mapDeps([0,1,2])));function Oe({note:t,open:s,onClose:r,onSave:l}){const{labels:d,getLabelsForNote:x,addLabelToNote:f,removeLabelFromNote:h}=L(),[u,n]=m.useState(""),[o,i]=m.useState(""),[p,c]=m.useState("default"),[j,b]=m.useState(!1),[k,O]=m.useState(!1),[C,N]=m.useState([]),_=m.useRef(null);m.useEffect(()=>{t?(n(t.title),i(t.content),c(t.color),N(x(t.id))):(n(""),i(""),c("default"),N([]))},[t,s,x]),m.useEffect(()=>{if(!k)return;const a=w=>{_.current&&!_.current.contains(w.target)&&O(!1)};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[k]);const E=async a=>{if(!t)return;C.some(g=>g.id===a.id)?(await h(t.id,a.id),N(g=>g.filter(A=>A.id!==a.id))):(await f(t.id,a.id),N(g=>[...g,a]))},T=async()=>{!u.trim()&&!o.trim()||(b(!0),await l({title:u,content:o,color:p}),b(!1),r())},R=v[p]??v.default;return e.jsx(Q,{open:s,onClose:T,children:e.jsxs("div",{style:{backgroundColor:R.bg},"data-color-mode":"dark",children:[e.jsx("input",{type:"text",placeholder:"Title",value:u,onChange:a=>n(a.target.value),className:"w-full px-6 pt-6 pb-2 bg-transparent text-white text-[16px] font-semibold placeholder-[#4a4660] outline-none"}),e.jsx("div",{className:"px-6",children:e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"h-[300px] flex items-center justify-center text-[#7a7890] text-[13px]",children:"Loading editor..."}),children:e.jsx(ye,{value:o,onChange:a=>i(a??""),preview:"edit",hideToolbar:!1,height:300,visibleDragbar:!1,style:{backgroundColor:"transparent",border:"none"}})})}),e.jsxs("div",{className:"px-5 py-3.5 flex items-center justify-between border-t border-white/[0.04]",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(D,{current:p,onChange:c}),t&&e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",ref:_,children:[C.map(a=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-[#ec4899]/25 text-[#f472b6] text-[11px] font-medium",children:[a.name,e.jsx(W,{size:10,className:"cursor-pointer hover:text-white transition-colors",onClick:()=>E(a)})]},a.id)),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>O(!k),className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[11px] text-[#7a7890] hover:text-[#b0adc0] hover:bg-white/[0.06] transition-colors",children:[e.jsx(S,{size:10}),e.jsx(ee,{size:10})]}),k&&d.length>0&&e.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-40 bg-[#1e1b2e] border border-[#3a3650] rounded-lg shadow-xl py-1 z-50",children:d.map(a=>{const w=C.some(g=>g.id===a.id);return e.jsxs("button",{onClick:()=>E(a),className:`w-full text-left px-3 py-1.5 text-[12px] hover:bg-white/[0.08] transition-colors flex items-center gap-2 ${w?"text-[#f472b6]":"text-[#c0bfd0]"}`,children:[e.jsx(S,{size:11}),e.jsx("span",{className:"truncate",children:a.name}),w&&e.jsx("span",{className:"ml-auto text-[10px]",children:"âœ“"})]},a.id)})})]})]})]}),e.jsxs("div",{className:"flex gap-2.5",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-[13px] text-[#7a7890] hover:text-white rounded-lg hover:bg-white/[0.04] transition-all",children:"Cancel"}),e.jsx("button",{onClick:T,disabled:j,className:"px-5 py-2 text-[13px] bg-[#ec4899] hover:bg-[#db2777] text-white font-medium rounded-full transition-all disabled:opacity-50",children:j?"...":"Save"})]})]})]})})}export{oe as A,Pe as N,Oe as a};
